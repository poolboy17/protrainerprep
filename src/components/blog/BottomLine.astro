---
export interface Props {
  title?: string;
  text?: string;
  affiliateUrl?: string;
  affiliateLabel?: string;
}

const { title = 'The Bottom Line', text, affiliateUrl, affiliateLabel = 'Get Started Today' } = Astro.props;

// Clean text: strip leading markdown heading if present (e.g. "## Bottom-line recommendation\n...")
const cleanText = text
  ? text.replace(/^##?\s+[^\n]*\n*/m, '').trim()
  : '';
---

<div class="not-prose my-8 rounded-xl bg-gray-900 p-6 text-white shadow-lg">
  <p class="text-xs font-bold uppercase tracking-widest text-primary mb-2">{title}</p>
  <div class="text-base leading-relaxed text-gray-300 [&>p]:mb-3">
    {cleanText ? <p>{cleanText}</p> : <slot />}
  </div>
  {affiliateUrl && (
    <div class="mt-4">
      <a
        href={affiliateUrl}
        target="_blank"
        rel="noopener sponsored"
        class="inline-flex items-center gap-2 rounded-lg bg-primary px-6 py-3 text-sm font-semibold text-white transition hover:bg-accent"
      >
        {affiliateLabel}
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
        </svg>
      </a>
    </div>
  )}
</div>
